<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>NZUBO ¬∑ ios purple</title>
  <!-- Font Awesome (icons) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Cloudinary upload widget -->
  <script src="https://upload-widget.cloudinary.com/global/all.js" type="text/javascript"></script>
  <!-- Firebase SDK (compat) -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-font-smoothing: antialiased;
      -webkit-tap-highlight-color: transparent;
    }

    :root {
      --white: #ffffff;
      --white-soft: #fafaff;
      --purple: #7c3aed;      /* vibrant purple */
      --purple-light: #c4b5fd;
      --purple-soft: #ede9fe;
      --gray-100: #f3f4f6;
      --gray-400: #9ca3af;
      --gray-700: #374151;
      --shadow-float: 0 20px 35px -10px rgba(124, 58, 237, 0.15), 0 5px 15px rgba(0,0,0,0.03);
      --radius-card: 28px;
      --radius-input: 18px;
    }

    body {
      font-family: -apple-system, 'Helvetica Neue', 'SF Pro Text', sans-serif;
      background: var(--white);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
      color: #1e1e2f;
    }

    /* main floating card */
    .phone-frame {
      width: 100%;
      max-width: 420px;  /* comfortable mobile width */
      margin: 0 auto;
    }

    .ios-card {
      background: var(--white);
      backdrop-filter: blur(2px);
      border-radius: var(--radius-card);
      padding: 28px 22px;
      box-shadow: var(--shadow-float);
      border: 2px solid var(--purple-light);   /* thin purple border */
      transition: all 0.2s ease;
    }

    /* header with big NZUBO + home */
    .nzubo-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 32px;
    }
    .nzubo-title {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .nzubo-title h1 {
      font-size: 3.2rem;      /* big */
      font-weight: 800;
      letter-spacing: -1.5px;
      color: var(--purple);
      text-shadow: 2px 2px 0 var(--purple-soft);
      line-height: 1;
    }
    .home-icon {
      background: var(--purple-soft);
      color: var(--purple);
      width: 48px;
      height: 48px;
      border-radius: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8rem;
      border: 2px solid var(--purple-light);
      box-shadow: 0 5px 0 var(--purple-soft);
    }

    /* login fields */
    .login-fields {
      margin-bottom: 28px;
    }
    .input-group {
      position: relative;
      margin-bottom: 20px;
    }
    .input-group i {
      position: absolute;
      left: 18px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--purple);
      font-size: 1.3rem;
      opacity: 0.8;
    }
    .input-group input {
      width: 100%;
      padding: 18px 18px 18px 52px;
      font-size: 1.05rem;
      border: 2px solid #e9e0ff;
      border-radius: var(--radius-input);
      background: var(--white);
      transition: all 0.15s;
      font-weight: 500;
    }
    .input-group input:focus {
      outline: none;
      border-color: var(--purple);
      box-shadow: 0 0 0 5px rgba(124,58,237,0.15);
    }
    .btn-login {
      background: var(--purple);
      color: white;
      border: none;
      padding: 18px;
      width: 100%;
      border-radius: 40px;
      font-size: 1.3rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      box-shadow: 0 8px 0 #4c1d95;
      transition: 0.1s linear;
      margin-top: 8px;
      border: 2px solid white;
      cursor: pointer;
    }
    .btn-login:active {
      transform: translateY(5px);
      box-shadow: 0 3px 0 #4c1d95;
    }

    /* register icons row */
    .register-row {
      display: flex;
      justify-content: space-around;
      margin: 32px 0 12px;
    }
    .reg-icon {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      background: var(--white);
      border: 2px solid var(--purple-light);
      border-radius: 50px;
      padding: 16px 0;
      width: 85px;
      box-shadow: 0 8px 0 #f0e9ff;
      transition: 0.1s;
      cursor: pointer;
      color: var(--purple);
    }
    .reg-icon i {
      font-size: 2.2rem;
    }
    .reg-icon span {
      font-weight: 700;
      font-size: 0.9rem;
      color: #2d2d4a;
    }
    .reg-icon:active {
      transform: translateY(5px);
      box-shadow: 0 3px 0 #e0d0ff;
    }

    /* MODAL overlay & cards */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(124, 58, 237, 0.2);
      backdrop-filter: blur(3px);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
      z-index: 1000;
      visibility: hidden;
      opacity: 0;
      transition: 0.2s;
    }
    .modal-overlay.show {
      visibility: visible;
      opacity: 1;
    }
    .modal-card {
      background: white;
      width: 100%;
      max-width: 460px;
      max-height: 90vh;
      overflow-y: auto;
      border-radius: 40px;
      padding: 26px 20px;
      border: 3px solid var(--purple);
      box-shadow: var(--shadow-float);
      position: relative;
    }
    .modal-card h2 {
      color: var(--purple);
      font-size: 2rem;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
      border-bottom: 2px dashed var(--purple-light);
      padding-bottom: 8px;
    }
    .close-modal {
      position: absolute;
      right: 20px;
      top: 20px;
      font-size: 2rem;
      color: var(--purple);
      background: none;
      border: none;
      cursor: pointer;
    }

    /* form elements inside modal */
    .upload-preview-sm {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: #f0e9ff;
      border: 2px dashed var(--purple);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    .preview-placeholder {
      display: flex;
      flex-direction: column;
      align-items: center;
      color: var(--purple);
    }
    .profile-upload-row {
      display: flex;
      gap: 20px;
      align-items: center;
      margin: 15px 0;
    }
    .upload-btns {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .btn-upload, .btn-remove {
      border: 2px solid var(--purple);
      background: white;
      color: var(--purple);
      border-radius: 40px;
      padding: 10px 16px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
    }
    .btn-remove {
      border-color: #f87171;
      color: #b91c1c;
    }
    .modal-field {
      margin-bottom: 18px;
    }
    .modal-field label {
      font-weight: 700;
      color: #2e1065;
      display: block;
      margin-bottom: 5px;
    }
    .modal-field input, .modal-field select {
      width: 100%;
      padding: 16px 18px;
      border: 2px solid #ddd6fe;
      border-radius: 30px;
      font-size: 1rem;
    }
    .city-datalist {
      width: 100%;
      padding: 16px 18px;
      border: 2px solid #ddd6fe;
      border-radius: 30px;
    }
    .btn-create {
      background: var(--purple);
      color: white;
      border: none;
      padding: 18px;
      width: 100%;
      border-radius: 40px;
      font-weight: 700;
      font-size: 1.2rem;
      margin-top: 20px;
      box-shadow: 0 5px 0 #4c1d95;
      cursor: pointer;
    }

    /* toast */
    .toast-container {
      position: fixed;
      bottom: 30px;
      left: 0;
      right: 0;
      display: flex;
      justify-content: center;
      z-index: 1200;
      pointer-events: none;
    }
    .toast {
      background: var(--purple);
      color: white;
      padding: 14px 28px;
      border-radius: 60px;
      font-weight: 600;
      box-shadow: 0 10px 25px rgba(124,58,237,0.4);
      border: 2px solid white;
    }

    /* city datalist */
    datalist {
      display: none;
    }
    .hidden {
      display: none;
    }
    small.generated-email {
      color: var(--purple);
      font-weight: 500;
      background: #f0e9ff;
      padding: 10px 18px;
      border-radius: 30px;
      display: inline-block;
      margin: 5px 0;
    }
  </style>
</head>
<body>
<div class="phone-frame">
  <div class="ios-card">
    <!-- big NZUBO + home icon -->
    <div class="nzubo-header">
      <div class="nzubo-title">
        <h1>NZUBO</h1>
        <div class="home-icon"><i class="fas fa-home"></i></div>
      </div>
    </div>

    <!-- login fields -->
    <div class="login-fields">
      <div class="input-group">
        <i class="fas fa-envelope"></i>
        <input type="email" id="loginEmail" placeholder="email" value="">
      </div>
      <div class="input-group">
        <i class="fas fa-lock"></i>
        <input type="password" id="loginPassword" placeholder="password">
        <i class="fas fa-eye" style="left: auto; right: 18px; cursor: pointer;" onclick="togglePassword()"></i>
      </div>
      <button class="btn-login" onclick="loginUser()"><i class="fas fa-arrow-right-to-bracket"></i> SIGN IN</button>
    </div>

    <!-- three floating icons for register -->
    <div class="register-row">
      <div class="reg-icon" onclick="openModal('landlordModal')">
        <i class="fas fa-building-user"></i>
        <span>LANDLORD</span>
      </div>
      <div class="reg-icon" onclick="openModal('tenantModal')">
        <i class="fas fa-user"></i>
        <span>TENANT</span>
      </div>
      <div class="reg-icon" onclick="openModal('agentModal')">
        <i class="fas fa-id-badge"></i>
        <span>AGENT</span>
      </div>
    </div>
    <p style="text-align: center; color: var(--purple); font-weight: 500; margin-top: 10px;">‚¨áÔ∏è tap to register ‚¨áÔ∏è</p>
  </div>
</div>

<!-- MODALS (landlord, tenant, agent) -->

<!-- LANDLORD MODAL -->
<div id="landlordModal" class="modal-overlay">
  <div class="modal-card">
    <button class="close-modal" onclick="closeModal('landlordModal')"><i class="fas fa-times-circle"></i></button>
    <h2><i class="fas fa-building-user"></i> Landlord</h2>
    <!-- profile upload area (unique ID) -->
    <div class="profile-upload-row" id="landlordUpload">
      <div class="upload-preview-sm" id="landlordPreview">
        <div class="preview-placeholder" id="landlordPlaceholder">
          <i class="fas fa-camera" style="font-size: 2rem;"></i>
          <span style="font-size:0.7rem;">add photo</span>
        </div>
        <img id="landlordImg" class="hidden" style="width:100%; height:100%; object-fit:cover;">
      </div>
      <div class="upload-btns">
        <button class="btn-upload" onclick="openCloudinaryFor('landlord')"><i class="fas fa-cloud-upload-alt"></i> upload</button>
        <button class="btn-remove" onclick="removeImage('landlord')"><i class="fas fa-trash"></i> remove</button>
      </div>
    </div>
    <!-- fields -->
    <div class="modal-field">
      <label>Full name</label>
      <input type="text" id="landlordName" placeholder="e.g. John Mulenga" oninput="updateLandlordEmail()">
    </div>
    <div class="modal-field">
      <label>üìß email (auto-generated)</label>
      <small class="generated-email" id="landlordEmailDisplay">landlord@name.com</small>
    </div>
    <div class="modal-field">
      <label>üìû phone</label>
      <input type="tel" id="landlordPhone" placeholder="+260 97...">
    </div>
    <div class="modal-field">
      <label>üèôÔ∏è city (search & select)</label>
      <input list="zambia-cities" id="landlordCity" placeholder="Type to search...">
      <datalist id="zambia-cities">
        <option>Lusaka</option><option>Kitwe</option><option>Ndola</option><option>Kabwe</option><option>Chingola</option><option>Mufulira</option><option>Livingstone</option><option>Chipata</option><option>Kasama</option><option>Solwezi</option><option>Mansa</option><option>Chililabombwe</option><option>Mazabuka</option><option>Monze</option><option>Mongu</option><option>Mbala</option><option>Kafue</option><option>Luanshya</option><option>Kalulushi</option>
      </datalist>
    </div>
    <div class="modal-field">
      <label>üîë password (min 6 chars)</label>
      <input type="password" id="landlordPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
    </div>
    <div class="modal-field">
      <label>‚úì confirm password</label>
      <input type="password" id="landlordConfirm" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
    </div>
    <button class="btn-create" onclick="registerLandlord()">CREATE ACCOUNT</button>
  </div>
</div>

<!-- TENANT MODAL -->
<div id="tenantModal" class="modal-overlay">
  <div class="modal-card">
    <button class="close-modal" onclick="closeModal('tenantModal')"><i class="fas fa-times-circle"></i></button>
    <h2><i class="fas fa-user"></i> Tenant</h2>
    <div class="profile-upload-row" id="tenantUpload">
      <div class="upload-preview-sm" id="tenantPreview">
        <div class="preview-placeholder" id="tenantPlaceholder"><i class="fas fa-camera" style="font-size:2rem;"></i><span>photo</span></div>
        <img id="tenantImg" class="hidden" style="width:100%; height:100%; object-fit:cover;">
      </div>
      <div class="upload-btns">
        <button class="btn-upload" onclick="openCloudinaryFor('tenant')"><i class="fas fa-cloud-upload-alt"></i> upload</button>
        <button class="btn-remove" onclick="removeImage('tenant')"><i class="fas fa-trash"></i> remove</button>
      </div>
    </div>
    <div class="modal-field"><label>Full name</label><input type="text" id="tenantName"></div>
    <div class="modal-field"><label>üìß email</label><input type="email" id="tenantEmail" placeholder="you@gmail.com"></div>
    <div class="modal-field"><label>üìû phone</label><input type="tel" id="tenantPhone"></div>
    <div class="modal-field"><label>üîë password</label><input type="password" id="tenantPassword"></div>
    <div class="modal-field"><label>‚úì confirm</label><input type="password" id="tenantConfirm"></div>
    <button class="btn-create" onclick="registerTenant()">CREATE ACCOUNT</button>
  </div>
</div>

<!-- AGENT MODAL -->
<div id="agentModal" class="modal-overlay">
  <div class="modal-card">
    <button class="close-modal" onclick="closeModal('agentModal')"><i class="fas fa-times-circle"></i></button>
    <h2><i class="fas fa-id-badge"></i> Agent</h2>
    <div class="profile-upload-row" id="agentUpload">
      <div class="upload-preview-sm" id="agentPreview">
        <div class="preview-placeholder" id="agentPlaceholder"><i class="fas fa-camera" style="font-size:2rem;"></i><span>photo</span></div>
        <img id="agentImg" class="hidden" style="width:100%; height:100%; object-fit:cover;">
      </div>
      <div class="upload-btns">
        <button class="btn-upload" onclick="openCloudinaryFor('agent')"><i class="fas fa-cloud-upload-alt"></i> upload</button>
        <button class="btn-remove" onclick="removeImage('agent')"><i class="fas fa-trash"></i> remove</button>
      </div>
    </div>
    <div class="modal-field"><label>Full name</label><input type="text" id="agentName" oninput="updateAgentEmail()"></div>
    <div class="modal-field"><label>üìß email (auto)</label><small class="generated-email" id="agentEmailDisplay">agent@name.com</small></div>
    <div class="modal-field"><label>üìû phone</label><input type="tel" id="agentPhone"></div>
    <div class="modal-field"><label>üèôÔ∏è city</label><input list="zambia-cities" id="agentCity" placeholder="search city"></div>
    <div class="modal-field"><label>üîë password</label><input type="password" id="agentPassword"></div>
    <div class="modal-field"><label>‚úì confirm</label><input type="password" id="agentConfirm"></div>
    <button class="btn-create" onclick="registerAgent()">CREATE ACCOUNT</button>
  </div>
</div>

<!-- toast container -->
<div class="toast-container" id="toast"></div>

<script>
  // Firebase config (DMKL project)
  const firebaseConfig = {
    apiKey: "AIzaSyCzf9dZFB0l7ZEPLJ4tpo4bSjgQNW3VTus",
    authDomain: "dmkl-8ea2c.firebaseapp.com",
    databaseURL: "https://dmkl-8ea2c-default-rtdb.firebaseio.com",
    projectId: "dmkl-8ea2c",
    storageBucket: "dmkl-8ea2c.firebasestorage.app",
    messagingSenderId: "155892504799",
    appId: "1:155892504799:web:45ed0037fd0fe79b85b16a",
    measurementId: "G-61M65C4MZ2"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.database();

  // Cloudinary settings (from first snippet)
  const CLOUDINARY_CONFIG = {
    cloudName: 'dd3lcymrk',
    uploadPreset: 'h3eyhc2o',
    folder: 'zynapse/profiles'
  };

  // per‚Äërole image URLs
  let landlordPhoto = '', tenantPhoto = '', agentPhoto = '';

  // ---------- UI helpers ----------
  function showToast(msg, duration = 2500) {
    const toast = document.getElementById('toast');
    toast.innerHTML = `<div class="toast">${msg}</div>`;
    setTimeout(() => toast.innerHTML = '', duration);
  }

  function togglePassword() {
    const pwd = document.getElementById('loginPassword');
    pwd.type = pwd.type === 'password' ? 'text' : 'password';
  }

  function openModal(id) { document.getElementById(id).classList.add('show'); }
  function closeModal(id) { document.getElementById(id).classList.remove('show'); }

  // dynamic email generation for landlord/agent
  function updateLandlordEmail() {
    const name = document.getElementById('landlordName').value.trim();
    const sanitized = name.replace(/\s+/g, '').toLowerCase() || 'name';
    document.getElementById('landlordEmailDisplay').innerText = `landlord@${sanitized}.com`;
  }
  function updateAgentEmail() {
    const name = document.getElementById('agentName').value.trim();
    const sanitized = name.replace(/\s+/g, '').toLowerCase() || 'name';
    document.getElementById('agentEmailDisplay').innerText = `agent@${sanitized}.com`;
  }

  // ---------- Cloudinary upload (per role) ----------
  function openCloudinaryFor(role) {
    const widget = cloudinary.createUploadWidget({
      cloudName: CLOUDINARY_CONFIG.cloudName,
      uploadPreset: CLOUDINARY_CONFIG.uploadPreset,
      sources: ['local', 'camera'],
      multiple: false,
      folder: CLOUDINARY_CONFIG.folder,
      cropping: true,
      croppingAspectRatio: 1
    }, (error, result) => {
      if (!error && result && result.event === 'success') {
        const url = result.info.secure_url;
        if (role === 'landlord') {
          landlordPhoto = url;
          document.getElementById('landlordImg').src = url;
          document.getElementById('landlordImg').classList.remove('hidden');
          document.getElementById('landlordPlaceholder').classList.add('hidden');
        } else if (role === 'tenant') {
          tenantPhoto = url;
          document.getElementById('tenantImg').src = url;
          document.getElementById('tenantImg').classList.remove('hidden');
          document.getElementById('tenantPlaceholder').classList.add('hidden');
        } else if (role === 'agent') {
          agentPhoto = url;
          document.getElementById('agentImg').src = url;
          document.getElementById('agentImg').classList.remove('hidden');
          document.getElementById('agentPlaceholder').classList.add('hidden');
        }
        showToast('üì∏ photo uploaded!');
      } else if (error) showToast('upload error', 2000);
    });
    widget.open();
  }

  function removeImage(role) {
    if (role === 'landlord') {
      landlordPhoto = ''; 
      document.getElementById('landlordImg').classList.add('hidden');
      document.getElementById('landlordPlaceholder').classList.remove('hidden');
    } else if (role === 'tenant') {
      tenantPhoto = '';
      document.getElementById('tenantImg').classList.add('hidden');
      document.getElementById('tenantPlaceholder').classList.remove('hidden');
    } else if (role === 'agent') {
      agentPhoto = '';
      document.getElementById('agentImg').classList.add('hidden');
      document.getElementById('agentPlaceholder').classList.remove('hidden');
    }
  }

  // ---------- REGISTER functions ----------
  function registerLandlord() {
    const name = document.getElementById('landlordName').value.trim();
    const phone = document.getElementById('landlordPhone').value.trim();
    const city = document.getElementById('landlordCity').value.trim();
    const pwd = document.getElementById('landlordPassword').value;
    const confirm = document.getElementById('landlordConfirm').value;
    if (!name || !phone || !city || !pwd || !confirm) return showToast('fill all fields');
    if (pwd !== confirm) return showToast('passwords differ');
    if (pwd.length < 6) return showToast('password min 6 chars');
    if (!landlordPhoto) return showToast('upload profile picture');

    const email = `landlord@${name.replace(/\s+/g, '').toLowerCase()}.com`;
    auth.createUserWithEmailAndPassword(email, pwd)
      .then(cred => {
        const uid = cred.user.uid;
        return db.ref('users/' + uid).set({
          role: 'landlord', name, phone, city, photo: landlordPhoto, email: email,
          createdAt: new Date().toISOString()
        }).then(() => {
          showToast(`‚úÖ landlord created! use email ${email} and your password.`);
          closeModal('landlordModal');
          // show popup message as requested
          setTimeout(() => alert(`please use email: ${email} and your chosen password to log in`), 300);
        });
      })
      .catch(err => showToast(err.message));
  }

  function registerAgent() {
    const name = document.getElementById('agentName').value.trim();
    const phone = document.getElementById('agentPhone').value.trim();
    const city = document.getElementById('agentCity').value.trim();
    const pwd = document.getElementById('agentPassword').value;
    const confirm = document.getElementById('agentConfirm').value;
    if (!name || !phone || !city || !pwd || !confirm) return showToast('fill all fields');
    if (pwd !== confirm) return showToast('passwords differ');
    if (pwd.length < 6) return showToast('password min 6 chars');
    if (!agentPhoto) return showToast('upload profile picture');

    const email = `agent@${name.replace(/\s+/g, '').toLowerCase()}.com`;
    auth.createUserWithEmailAndPassword(email, pwd)
      .then(cred => {
        const uid = cred.user.uid;
        return db.ref('users/' + uid).set({
          role: 'agent', name, phone, city, photo: agentPhoto, email: email,
          createdAt: new Date().toISOString()
        }).then(() => {
          showToast(`‚úÖ agent created! use email ${email}`);
          closeModal('agentModal');
          setTimeout(() => alert(`please use email: ${email} and your chosen password to log in`), 300);
        });
      })
      .catch(err => showToast(err.message));
  }

  function registerTenant() {
    const name = document.getElementById('tenantName').value.trim();
    const email = document.getElementById('tenantEmail').value.trim();
    const phone = document.getElementById('tenantPhone').value.trim();
    const pwd = document.getElementById('tenantPassword').value;
    const confirm = document.getElementById('tenantConfirm').value;
    if (!name || !email || !phone || !pwd || !confirm) return showToast('fill all fields');
    if (pwd !== confirm) return showToast('passwords differ');
    if (pwd.length < 6) return showToast('password min 6 chars');
    if (!tenantPhoto) return showToast('upload profile picture');

    auth.createUserWithEmailAndPassword(email, pwd)
      .then(cred => {
        const uid = cred.user.uid;
        return db.ref('users/' + uid).set({
          role: 'tenant', name, phone, photo: tenantPhoto, email: email,
          createdAt: new Date().toISOString()
        }).then(() => {
          showToast('‚úÖ tenant registered!');
          closeModal('tenantModal');
        });
      })
      .catch(err => showToast(err.message));
  }

  // ---------- LOGIN (with role redirect) ----------
  function loginUser() {
    const email = document.getElementById('loginEmail').value.trim();
    const pwd = document.getElementById('loginPassword').value;
    if (!email || !pwd) return showToast('enter email/password');

    auth.signInWithEmailAndPassword(email, pwd)
      .then(cred => {
        const uid = cred.user.uid;
        return db.ref('users/' + uid).once('value').then(snap => snap.val());
      })
      .then(userData => {
        if (!userData) throw new Error('no role data');
        const role = userData.role;
        let redirect = '';
        if (role === 'tenant') redirect = 'tenant.html';
        else if (role === 'agent') redirect = 'agent.html';
        else if (role === 'landlord') redirect = 'landlord.html';
        else redirect = 'index.html';
        showToast(`welcome ${userData.name}`);
        setTimeout(() => window.location.href = redirect, 1000);
      })
      .catch(err => showToast('login error: ' + err.message));
  }

  // hide modals on overlay click (optional)
  document.querySelectorAll('.modal-overlay').forEach(overlay => {
    overlay.addEventListener('click', (e) => {
      if (e.target.classList.contains('modal-overlay')) 
        overlay.classList.remove('show');
    });
  });

  // initial email displays
  window.addEventListener('DOMContentLoaded', () => {
    updateLandlordEmail();
    updateAgentEmail();
  });
</script>
</body>
</html>
